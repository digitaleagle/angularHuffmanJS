/*! angularHuffmanJS 2015-12-27 */
angular.module("HuffmanJS",[]).service("hjEncodeDecode",function(){var a=void 0,b="abcdefghijklmnopqrstuvwxyz0123456789 abcdefghijklmnopqrstuvwxyz;",c=function(){a=Huffman.treeFromText(b),console.log(a)};this.encode=function(b){return void 0===a&&c(),a.encode(b)},this.decode=function(b){return void 0===a&&c(),a.decode(b)},this.getTreeText=function(){return b},this.setTreeText=function(a){b=a,c()}});var Huffman;Huffman={treeFromText:function(a){var b;return b=new Huffman.TreeBuilder(a),b.build()}},Huffman.CoreHelpers={isArray:function(a){return!(!a||a.constructor!==Array)},lpad:function(a,b){for(b=b||8;a.length<b;)a="0"+a;return a}},Huffman.Tree=function(a){return this.root=a,this.root=this.root||new Huffman.Tree.Node,this},Huffman.Tree.prototype.encode=function(a){return this.bitStringToString(this.encodeBitString(a))},Huffman.Tree.prototype.decode=function(a){var b,c,d,e,f,g,h,i;for(e=this.stringToBitString(a),g="",i=this.root,c=e.split(""),b=0,d=c.length;d>b;b++)h=c[b],f="0"===h?"left":"right",i=i[f],i.isLeaf()&&(g+=i.value,i=this.root);return g},Huffman.Tree.prototype.encodeBitString=function(a){var b,c,d,e,f;for(f="",c=a.split(""),b=0,d=c.length;d>b;b++)e=c[b],f+=this.bitValue(e);return f},Huffman.Tree.prototype.bitStringToString=function(a){var b,c,d,e,f;for(f=8-a.length%8,e=0;f>=0?f>e:e>f;f>=0?e+=1:e-=1)a+="0";return d=function(){for(b=[],c=a.length,e=0;c>=0?c>e:e>c;e+=8)b.push(String.fromCharCode(parseInt(a.substr(e,8),2)));return b}(),d.join("")+f.toString()},Huffman.Tree.prototype.stringToBitString=function(a){var b,c,d,e,f,g,h;return h=a.split(""),g=parseInt(h.pop()),h=function(){for(b=[],d=h,c=0,e=d.length;e>c;c++)f=d[c],b.push(Huffman.CoreHelpers.lpad(f.charCodeAt(0).toString(2)));return b}(),h=h.join(""),h.substr(0,h.length-g)},Huffman.Tree.prototype.bitValue=function(a){var b;return("undefined"==typeof(b=this.leafCache)||null===b)&&this.generateLeafCache(),this.leafCache[a]},Huffman.Tree.prototype.generateLeafCache=function(a,b){return this.leafCache="undefined"!=typeof this.leafCache&&null!==this.leafCache?this.leafCache:{},a=a||this.root,b=b||"",a.isLeaf()?this.leafCache[a.value]=b:(this.generateLeafCache(a.left,b+"0"),this.generateLeafCache(a.right,b+"1"))},Huffman.Tree.prototype.encodeTree=function(){return this.root.encode()},Huffman.Tree.decodeTree=function(a){return new Huffman.Tree(Huffman.Tree.parseNode(a))},Huffman.Tree.parseNode=function(a){var b;return b=new Huffman.Tree.Node,Huffman.CoreHelpers.isArray(a)?(b.left=Huffman.Tree.parseNode(a[0]),b.right=Huffman.Tree.parseNode(a[1])):b.value=a,b},Huffman.Tree.Node=function(){return this.left=this.right=this.value=null,this},Huffman.Tree.Node.prototype.isLeaf=function(){return this.left===this.right&&null===this.right},Huffman.Tree.Node.prototype.encode=function(){return this.value?this.value:[this.left.encode(),this.right.encode()]};var __hasProp=Object.prototype.hasOwnProperty;Huffman.TreeBuilder=function(a){return this.text=a,this},Huffman.TreeBuilder.prototype.build=function(){var a,b;return b=this.buildFrequencyTable(),a=this.combineTable(b),Huffman.Tree.decodeTree(this.compressCombinedTable(a))},Huffman.TreeBuilder.prototype.buildFrequencyTable=function(){var a,b,c,d,e,f,g,h;for(h={},b=this.text.split(""),a=0,c=b.length;c>a;a++)e=b[a],h[e]="undefined"!=typeof h[e]&&null!==h[e]?h[e]:0,h[e]+=1;g=[],d=h;for(e in d)__hasProp.call(d,e)&&(f=d[e],g.push([f,e]));return g.sort(this.frequencySorter),g},Huffman.TreeBuilder.prototype.frequencySorter=function(a,b){return a[0]>b[0]?1:a[0]<b[0]?-1:0},Huffman.TreeBuilder.prototype.combineTable=function(a){for(var b,c;a.length>1;)b=a.shift(),c=a.shift(),a.push([b[0]+c[0],[b,c]]),a.sort(this.frequencySorter);return a[0]},Huffman.TreeBuilder.prototype.compressCombinedTable=function(a){var b;return b=a[1],Huffman.CoreHelpers.isArray(b)?[this.compressCombinedTable(b[0]),this.compressCombinedTable(b[1])]:b};